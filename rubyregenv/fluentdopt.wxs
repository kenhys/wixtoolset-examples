<?xml version="1.0" encoding="utf-8"?>
<!--
    # This comment is generated by WixEdit, the specific commandline
    # arguments for the WiX Toolset are stored here.

    candleArgs: 
    lightArgs: "<projectname>.wixobj" -out "<projectname>.msi" <extensions> -ext WixUIExtension
-->
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi" xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">
  <Product Id="acc98d08-ffda-4470-bfa4-b0c85e52a320" Name="RubyFluentdWinSVC" Language="1033" Version="0.0.0.1" Manufacturer="WixEdit" UpgradeCode="474379ec-b108-4492-8e4b-874edb27cc32">
    <Package
        Description="Test file in a Product"
        Comments="Simple test"
        InstallerVersion="200"
        InstallPrivileges="elevated"
        InstallScope="perMachine"
        Compressed="yes" />
    <Media Id="1" Cabinet="simple.cab" EmbedCab="yes" />
    <SetDirectory Id="WINDOWSVOLUME" Value="[WindowsVolume]" />
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="WINDOWSVOLUME">
        <Directory Id="OPTLOCATION" Name="opt">
          <Directory Id="PROJECTLOCATION" Name="fluentdopt">
            <Component Id="TraverseAcl" Guid="6aca2755-77ec-49be-bd37-3f026fad8bc3">
              <CreateFolder>
                <PermissionEx Sddl="D:(A;OICI;0x1200a9;;;BU)(A;OICI;FA;;;BA)(A;OICI;FA;;;S-1-5-80-956008885-3418522649-1831038044-1853292631-2271478464)(A;OICI;FA;;;CO)(A;OICI;FA;;;SY)"/>
              </CreateFolder>
            </Component>
          </Directory>
        </Directory>
      </Directory>
    </Directory>

    <DirectoryRef Id="PROJECTLOCATION">
      <Component Id="fluentdwinsvc"
                 Guid="35b72e6a-a373-40d3-aca4-6aef15750aa9">
        <File Name="fluentdwinsvc.rb"
              KeyPath="yes"
              Source="fluentdwinsvc.rb" />
      </Component>
    </DirectoryRef>

    <Feature Id="DefaultFeature" Title="Main Feature" Level="1">
      <ComponentRef Id="fluentdwinsvc" />
      <ComponentRef Id="TraverseAcl" />
    </Feature>

    <Property Id="InstallFluentdWinSvcFluentdopt" Value=" "/>
    <CustomAction Id="SetInstallFluentdWinSvcFluentdoptCommand"
                  Property="InstallFluentdWinSvcFluentdopt"
                  Value="&quot;[FLUENTPROJECTLOCATION]bin\ruby.exe&quot; &quot;[PROJECTLOCATION]fluentdwinsvc.rb&quot; &quot;[FLUENTPROJECTLOCATION]&quot;"/>
    <CustomAction Id="InstallFluentdWinSvcFluentdopt"
                  BinaryKey="WixCA"
                  DllEntry="WixQuietExec64"
                  Execute="deferred"
                  Return="check"
                  Impersonate="no" />

    <Property Id="FLUENTPROJECTLOCATION" Value=" "/>
    <CustomAction Id="SetFluentProjectLocation"
                  Property="FLUENTPROJECTLOCATION"
                  Value="[OPTLOCATION]fluent\"/>

    <InstallExecuteSequence>
      <Custom Action="SetFluentProjectLocation" After="InstallFiles">NOT Installed OR WIX_UPGRADE_DETECTED</Custom>
      <Custom Action="SetInstallFluentdWinSvcFluentdoptCommand" After="SetFluentProjectLocation">NOT Installed OR WIX_UPGRADE_DETECTED</Custom>
      <Custom Action="InstallFluentdWinSvcFluentdopt" After="SetInstallFluentdWinSvcFluentdoptCommand">NOT Installed OR WIX_UPGRADE_DETECTED</Custom>
    </InstallExecuteSequence>
    <UI />
  </Product>
</Wix>
